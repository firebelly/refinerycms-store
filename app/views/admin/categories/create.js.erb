var errors = <%= @category.errors.length %>;
if (errors > 0) {
  var error_messages = '';
  <% @category.errors.each do |field, message| %>
    $('#category_<%= field %>').wrap('<span class="fieldWithErrors" />');
    $('label[for="category_<%= field %>"').wrap('<span class="fieldWithErrors" />');
    error_messages += '<li><%= "#{field.to_s.capitalize} #{escape_javascript(message)}" %></li>';
  <% end %>

  $('#flash_container').html('<div class="errorExplanation" id="errorExplanation"><p>There were problems:</p><ul>' + error_messages + '</ul></div>');
  $('.save-loader').hide();
} else {

  // Close dialog
  $(parent.document.body).removeClass('hide-overflow');
  window_dialog = parent.$('.ui-dialog-content');
  window_dialog.filter(':data(dialog)').dialog('close');
  window_dialog.remove();
}
